<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat - Proyectos Interdisciplinarios</title>
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="chat.css">
</head>
<body>
  <!-- NAVIGATION SIDEBAR -->
  <aside class="nav-sidebar" id="navSidebar">
    <a href="home.html" class="sidebar-item">
      <div class="sidebar-item-icon">
        <img src="https://uxwing.com/wp-content/themes/uxwing/download/web-app-development/home-page-white-icon.png" width="20" alt="Inicio">
      </div>
      <div class="sidebar-item-label">Inicio</div>
    </a>

    <a href="misProyectos.html" class="sidebar-item">
      <div class="sidebar-item-icon">
        <img src="https://cdn2.iconfinder.com/data/icons/leto-most-searched-mix-3/64/__menu_more-28-512.png" width="30" alt="Mis Proyectos">
      </div>
      <div class="sidebar-item-label">MisProyectos</div>
    </a>

    <a href="chat.html" class="sidebar-item active">
      <div class="sidebar-item-icon">
        <img src="https://www.nicepng.com/png/full/128-1284530_chat-icon-png-white-chat-icon-white-png.png" width="20" alt="Mensajes">
      </div>
      <div class="sidebar-item-label">Mensajes</div>
    </a>
  </aside>

  <!-- CONVERSATIONS SIDEBAR -->
  <div class="conversations-sidebar" id="conversationsSidebar">
    <div class="sidebar-header">
      <h5>Mensajes</h5>
      <button class="new-chat-btn" onclick="startNewChat()" aria-label="Nuevo chat">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/White_pencil.png/1200px-White_pencil.png" width="16" alt="Nuevo">
      </button>
    </div>
    
    <div class="conversations" id="conversationsList">
      <div class="conversation-item active" onclick="loadChat(1)" data-chat-id="1">
        <div class="avatar">MG</div>
        <div class="conversation-info">
          <h6>María González</h6>
          <small>¿Cuándo podemos reunirnos?</small>
        </div>
        <div class="conversation-time">10 min</div>
      </div>
      
      <div class="conversation-item" onclick="loadChat(2)" data-chat-id="2">
        <div class="avatar">CR</div>
        <div class="conversation-info">
          <h6>Carlos Ruiz</h6>
          <small>Me interesa tu proyecto de...</small>
        </div>
        <div class="conversation-time">1h</div>
      </div>
      
      <div class="conversation-item" onclick="loadChat(3)" data-chat-id="3">
        <div class="avatar">AL</div>
        <div class="conversation-info">
          <h6>Ana López</h6>
          <small>Gracias por aplicar!</small>
        </div>
        <div class="conversation-time">2h</div>
      </div>
      
      <div class="conversation-item" onclick="loadChat(4)" data-chat-id="4">
        <div class="avatar">RD</div>
        <div class="conversation-info">
          <h6>Roberto Díaz</h6>
          <small>El deadline es el viernes</small>
        </div>
        <div class="conversation-time">1d</div>
      </div>
      
      <div class="conversation-item" onclick="loadChat(5)" data-chat-id="5">
        <div class="avatar">JP</div>
        <div class="conversation-info">
          <h6>Juan Pérez</h6>
          <small>Perfecto, nos vemos mañana</small>
        </div>
        <div class="conversation-time">2d</div>
      </div>
      
      <div class="conversation-item" onclick="loadChat(6)" data-chat-id="6">
        <div class="avatar">LM</div>
        <div class="conversation-info">
          <h6>Laura Martínez</h6>
          <small>Te envié los archivos</small>
        </div>
        <div class="conversation-time">3d</div>
      </div>
    </div>
  </div>

  <!-- CHAT WINDOW -->
  <div class="chat-window">
    <div class="chat-header">
      <div class="chat-header-left">
        <button class="back-btn" onclick="toggleConversationsSidebar()">←</button>
        <div class="chat-avatar" id="chatAvatar">MG</div>
        <div class="chat-header-info">
          <h5 id="chatName">María González</h5>
          <small id="chatStatus">En línea</small>
        </div>
      </div>
      <div class="header-actions">
        <button onclick="showChatInfo()" aria-label="Información del chat">⋮</button>
      </div>
    </div>
    
    <div class="messages-container" id="messagesContainer">
      <!-- Messages will be loaded here dynamically -->
    </div>
    
    <div class="input-area">
      <div class="input-actions">
        <button onclick="attachFile()" aria-label="Adjuntar archivo">
          <img src="https://static.vecteezy.com/system/resources/previews/011/912/003/non_2x/plus-sign-icon-free-png.png" width="20" alt="Adjuntar">
        </button>
      </div>
      <input type="text" class="message-input" id="messageInput" placeholder="Escribe un mensaje..." onkeypress="handleKeyPress(event)">
      <button class="send-btn" id="sendBtn" onclick="sendMessage()" aria-label="Enviar mensaje">
        ➤
      </button>
    </div>
  </div>

  <!-- MODAL: Nueva Conversación -->
  <div class="modal" id="newChatModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Nueva Conversación</h3>
        <button class="close-modal" onclick="closeModal('newChatModal')">✕</button>
      </div>
      <div class="modal-body">
        <div class="search-users">
          <input type="text" id="searchUserInput" class="search-input" placeholder="Buscar usuarios..." oninput="searchUsers()">
        </div>
        <div class="users-list" id="usersList">
          <div class="user-item" onclick="startChatWith('Pedro Sánchez', 'PS')">
            <div class="user-avatar">PS</div>
            <div class="user-info">
              <h6>Pedro Sánchez</h6>
              <small>Desarrollador Mobile</small>
            </div>
          </div>
          <div class="user-item" onclick="startChatWith('Sofia Chen', 'SC')">
            <div class="user-avatar">SC</div>
            <div class="user-info">
              <h6>Sofia Chen</h6>
              <small>Programadora</small>
            </div>
          </div>
          <div class="user-item" onclick="startChatWith('Miguel Torres', 'MT')">
            <div class="user-avatar">MT</div>
            <div class="user-info">
              <h6>Miguel Torres</h6>
              <small>Full Stack Developer</small>
            </div>
          </div>
          <div class="user-item" onclick="startChatWith('Patricia Gómez', 'PG')">
            <div class="user-avatar">PG</div>
            <div class="user-info">
              <h6>Patricia Gómez</h6>
              <small>Especialista en Finanzas</small>
            </div>
          </div>
          <div class="user-item" onclick="startChatWith('Diego Torres', 'DT')">
            <div class="user-avatar">DT</div>
            <div class="user-info">
              <h6>Diego Torres</h6>
              <small>Marketing Digital</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Adjuntar Archivo -->
  <div class="modal" id="attachFileModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Adjuntar Archivo</h3>
        <button class="close-modal" onclick="closeModal('attachFileModal')">✕</button>
      </div>
      <div class="modal-body">
        <div class="file-options">
          <div class="file-option" onclick="selectFileType('image')">
            <div class="file-icon"><img src="https://images.vexels.com/media/users/3/128417/isolated/lists/d437da2a54918895cf59a3362a0099ec-icono-plano-de-album-de-fotos.png" width="50"></div>
            <div class="file-label">Imagen</div>
            <small>JPG, PNG, GIF</small>
          </div>
          <div class="file-option" onclick="selectFileType('document')">
            <div class="file-icon"><img src="https://cdn-icons-png.flaticon.com/256/6747/6747196.png" width="50"></div>
            <div class="file-label">Documento</div>
            <small>PDF, Word, Excel</small>
          </div>
          <div class="file-option" onclick="selectFileType('video')">
            <div class="file-icon"><img src="https://cdn-icons-png.flaticon.com/512/6512/6512789.png" width="50"></div>
            <div class="file-label">Video</div>
            <small>MP4, AVI, MOV</small>
          </div>
          <div class="file-option" onclick="selectFileType('link')">
            <div class="file-icon"><img src="https://cdn-icons-png.flaticon.com/512/7471/7471685.png" width="50"></div>
            <div class="file-label">Enlace</div>
            <small>URL, Link</small>
          </div>
        </div>
        <div class="file-upload-area" id="fileUploadArea" style="display: none;">
          <input type="file" id="fileInput" style="display: none;" onchange="handleFileSelect(event)">
          <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
            <img src="https://cdn-icons-png.flaticon.com/512/10771/10771418.png" width="60"> Seleccionar archivo
          </button>
          <p class="upload-note">O arrastra el archivo aquí</p>
        </div>
        <div class="link-input-area" id="linkInputArea" style="display: none;">
          <input type="text" class="link-input" id="linkInput" placeholder="Pega el enlace aquí...">
          <button class="btn-primary" onclick="sendLink()">Enviar enlace</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Información del Chat -->
  <div class="modal" id="chatInfoModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Información del Chat</h3>
        <button class="close-modal" onclick="closeModal('chatInfoModal')">✕</button>
      </div>
      <div class="modal-body">
        <div class="chat-info-profile">
          <div class="profile-avatar" id="infoAvatar">MG</div>
          <h4 id="infoName">María González</h4>
          <p id="infoStatus">En línea</p>
        </div>
        <div class="info-options">
          <!--
          Removed due to lack of time to complete
          <div class="info-option" onclick="viewProfile()">
            <span class="option-icon"><img src=""></span>
            <span class="option-text">Ver perfil completo</span>
          </div>
          <div class="info-option" onclick="viewSharedFiles()">
            <span class="option-icon"><img src=""></span>
            <span class="option-text">Archivos compartidos</span>
          </div>
          <div class="info-option" onclick="muteConversation()">
            <span class="option-icon"><img src="https://cdn-icons-png.flaticon.com/512/17366/17366845.png" width="30" height=""></span>
            <span class="option-text">Silenciar conversación</span>
          </div>
          -->
          <div class="info-option" onclick="blockUser()">
            <span class="option-icon"><img src="https://cdn-icons-png.freepik.com/512/15222/15222539.png" width="35"></span>
            <span class="option-text">Bloquear usuario</span>
          </div>
          <div class="info-option danger" onclick="deleteConversation()">
            <span class="option-icon"><img src="https://cdn-icons-png.flaticon.com/512/10319/10319444.png" width="30"></span>
            <span class="option-text">Eliminar conversación</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Custom JS -->
  <script src="chat.js"></script>
</body>
</html>